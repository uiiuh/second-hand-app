```vue
<template>
	<view class="signUpIntentionalInfo">
		<!-- 头部步骤条 -->
		<view class="header">
			<u-steps :current="current">
				<u-steps-item title="意向方信息填写"></u-steps-item>
				<u-steps-item title="基本信息填写"></u-steps-item>
				<u-steps-item title="附件上传"></u-steps-item>
			</u-steps>
		</view>
		<!-- bug：
			1.当我点击下一步后切换到下个页面，页面的滚动条位置自动在上个页面滚动条的位置，应需要回到顶部
			2.所有选择是/否的选择器，当选择 "否" 时，选择器的文本显示异常（已解决，但是注意有些字段的值是整数，而不是字符串）
			3.很多字典都不对
			4.web端很多字段都自动帮你填上了
			5.点击添加自然人和法人按钮时控制台报错
			6.添加法人中，成立日期只能选今天及以后得日期，理应选今天及以前才对
			7.上传附件需要做文件格式限制和校验
			8.上传附件后会自动预览文件，如果我上传的文档，预览会有问题
		-->
		<!-- 信息填写表单 -->
		<view class="intentionalInfoBox">
			<u--form labelPosition="top" :model="form" :rules="rules" labelWidth="200" v-if="!isSubmit" ref="uForm">
				<!-- 意向方信息填写页 -->
				<view v-if="current==0">
					<u-form-item label="意向方类型" prop="interestedPartyType" labelPosition="top" borderBottom>
						<u--input placeholder="需要自动填写值" v-model="form.interestedPartyType" border="none"></u--input>
					</u-form-item>
					<u-form-item label="意向方名称" prop="interestedPartyName" labelPosition="top" borderBottom>
						<u--input placeholder="需要自动填写值" v-model="form.interestedPartyName" border="none"></u--input>
					</u-form-item>
					<u-form-item label="项目编号" prop="projectId" labelPosition="top" borderBottom>
						<u--input placeholder="需要自动填写值" v-model="form.projectId" border="none"></u--input>
					</u-form-item>
					<u-form-item label="项目名称" prop="projectName" labelPosition="top" borderBottom>
						<u--input placeholder="需要自动填写值" v-model="form.projectName" border="none"></u--input>
					</u-form-item>
					<!-- web端有自动填写地址 -->
					<u-form-item label="地域" prop="farea" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.farea" :dictValue="regionOptions"></dict-picker>
					</u-form-item>
					<!-- 境内 -->
					<u-form-item label="省市区" prop="area" borderBottom labelPosition="top" required="true" v-if="form.farea==='0'">
						<view class="taskName2" @click="changeAreaType" style="color: #808080;">
							<text :class="!!form.area ? 'select' : ''">
								{{form.area ? (form.province+form.city+form.area ): '请选择所在地区' }}
							</text>
						</view>
						<u-picker ref="uPicker" :show="showAreaPicker" :columns="columns" @cancel="cancelAreaPicker" @confirm="confirmArea" @change="changeHandler"></u-picker>
					</u-form-item>
					<!-- 境外 -->
					<u-form-item label="国家" prop="country" borderBottom labelPosition="top" required="true" v-if="form.farea==='1'">
						<view class="taskName2" @click="changeAreaType" style="color: #808080;">
							<text :class="!!form.country ? 'select' : ''">
								{{form.country ? form.country: '请选择国家' }}
							</text>
						</view>
						<u-picker ref="uPicker" :show="showAreaPicker" :columns="country" keyName="label" @cancel="cancelAreaPicker" @confirm="confirmCountry"></u-picker>
					</u-form-item>
					<!-- 港澳台 -->
					<u-form-item label="港澳台" prop="gat" borderBottom labelPosition="top" required="true" v-if="form.farea==='2'">
						<view class="taskName2" @click="changeAreaType" style="color: #808080;">
							<text :class="!!form.gat ? 'select' : ''">
								{{form.gat ? form.gat: '请选择所在地' }}
							</text>
						</view>
						<u-picker ref="uPicker" :show="showAreaPicker" :columns="gatColumns" keyName="label" @cancel="cancelAreaPicker" @confirm="confirmGat"></u-picker>
					</u-form-item>
					<u-form-item label="注册地(住所)" prop="address" labelPosition="top" borderBottom>
						<u--input placeholder="请输入" v-model="form.address" border="none"></u--input>
					</u-form-item>
					<u-form-item label="是否国资" prop="stateOwned" labelPosition="top" borderBottom>
						<dict-picker v-model="form.stateOwned" :dictValue="ornotOption"></dict-picker>
					</u-form-item>
					<u-form-item label="法定代表人或负责人" prop="legalRepresentative" labelPosition="top" required borderBottom>
						<u--input placeholder="请输入" v-model="form.legalRepresentative" border="none"></u--input>
					</u-form-item>
					<!-- 这个证件类型好像是企业的：统一社会信用代码 或 其他，按理应该是一个选择器，而不是 input -->
					<u-form-item label="证件类别" prop="idType" labelPosition="top" borderBottom>
						<u--input placeholder="请输入" v-model="form.idType" border="none"></u--input>
					</u-form-item>
					<!-- 证件编码应该是填统一社会信用代码吧 -->
					<u-form-item label="证件编号" prop="unifiedSocialCreditCode" labelPosition="top" borderBottom>
						<u--input placeholder="请输入" v-model="form.unifiedSocialCreditCode" border="none"></u--input>
					</u-form-item>
					<u-form-item label="所属行业类别" prop="industry" labelPosition="top" borderBottom>
						<dict-picker v-model="form.industry" :dictType="'mch_industry'"></dict-picker>
					</u-form-item>
					<u-form-item label="所属行业" prop="industry2" labelPosition="top" borderBottom>
						<dict-picker v-model="form.industry2" :dictType="'mch_industry'"></dict-picker>
					</u-form-item>
					<u-form-item label="注册资本(万元)" prop="registeredCapital" labelPosition="top" borderBottom>
						<u--input placeholder="请输入" v-model="form.registeredCapital" border="none"></u--input>
					</u-form-item>
					<u-form-item label="注册资本币种" prop="moneyType" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.moneyType" :dictValue="moneyTypeOption"></dict-picker>
					</u-form-item>
					<!-- 企业类型、经营规模、经济类型字典不对？ -->
					<u-form-item label="企业类型" prop="businessType" labelPosition="top" required="true" borderBottom>
						<dict-picker v-model="form.businessType" :dictType="'mch_industry'"></dict-picker>
					</u-form-item>
					<u-form-item label="经营规模" prop="operationScale" labelPosition="top" borderBottom required="true">
						<dict-picker v-model="form.operationScale" :dictType="'mch_industry'"></dict-picker>
					</u-form-item>
					<u-form-item label="经济类型" prop="economicType" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.economicType" :dictValue="moneyTypeOption"></dict-picker>
					</u-form-item>
					<u-form-item label="联系人" prop="contacts" labelPosition="top" borderBottom required="true">
						<u--input placeholder="请输入" v-model="form.contacts" border="none"></u--input>
					</u-form-item>
					<u-form-item label="联系人手机号" prop="contactPhone" labelPosition="top" borderBottom required="true">
						<u--input placeholder="请输入" v-model="form.contactPhone" border="none"></u--input>
					</u-form-item>
					<u-form-item label="通讯地址" prop="contactAddress" labelPosition="top" borderBottom required="true">
						<u--input placeholder="请输入" v-model="form.contactAddress" border="none"></u--input>
					</u-form-item>
					<u-form-item label="联系人电子邮箱" prop="contactEmail" labelPosition="top" borderBottom>
						<u--input placeholder="请输入" v-model="form.contactEmail" border="none"></u--input>
					</u-form-item>
					<u-form-item label="经营范围" prop="businessScope" labelPosition="top" borderBottom>
						<u--textarea placeholder="请输入" v-model="form.businessScope" border="none"></u--textarea>
					</u-form-item>
					<!-- web端好像没有这些 -->
					<!-- <u-form-item label="国资监管机构" prop="stateOwnedRegulator" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.stateOwnedRegulator" :dictValue="moneyTypeOption"></dict-picker>
					</u-form-item>
					<u-form-item label="国家出资企业或主管部门" prop="stateFundedEnterpriseName" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.stateFundedEnterpriseName" :dictValue="moneyTypeOption"></dict-picker>
					</u-form-item>
					<u-form-item label="监管机构属地(省)" prop="agencyTerritoryProvince" labelPosition="top" borderBottom required="true">
						<dict-picker v-model="form.agencyTerritoryProvince" :dictValue="moneyTypeOption"></dict-picker>
					</u-form-item>
					<u-form-item label="统一社会信用码" prop="unifiedSocialCreditCode2" labelPosition="top" borderBottom required="true">
						<u--input placeholder="请输入" v-model="form.unifiedSocialCreditCode2" border="none"></u--input>
					</u-form-item> -->
				</view>
				<!-- 基本信息填写页 -->
				<view v-if="current==1 && isShowBaseInfo">
					<u-form-item label="项目编号" prop="projectId" labelPosition="top" borderBottom>
						<u--input placeholder="需要自动填写值" v-model="form.projectId" border="none"></u--input>
					</u-form-item>
					<u-form-item label="项目名称" prop="projectName" labelPosition="top" borderBottom>
						<u--input placeholder="需要自动填写值" v-model="form.projectName" border="none"></u--input>
					</u-form-item>
					<!-- <u-form-item label="是否权利人" prop="obligee" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.obligee" :dictValue="ornotOption"></dict-picker>
					</u-form-item> -->
					<u-form-item label="是否代付" prop="payForAnother" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.payForAnother" :dictValue="ornotOption"></dict-picker>
					</u-form-item>
					<u-form-item label="是否涉外" prop="concerningForeign" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.concerningForeign" :dictValue="ornotOption"></dict-picker>
					</u-form-item>
					<!-- 代付和涉外都为否时，展示银行卡信息 -->
					<view v-if="form.payForAnother=='0' && form.concerningForeign=='0'">
						<u-form-item label="选择我的银行卡" prop="bankCard" borderBottom labelPosition="top" required="true">
							<dict-picker v-model="form.bankCard" :dictValue="ornotOption"></dict-picker>
						</u-form-item>
						<u-form-item label="银行账户名称" prop="cardAccountName" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" disabled="true" v-model="form.cardAccountName" border="none"></u--input>
						</u-form-item>
						<u-form-item label="开户银行" prop="openAccountBank" borderBottom labelPosition="top" required="true">
							<dict-picker v-model="form.openAccountBank" :dictValue="ornotOption"></dict-picker>
						</u-form-item>
						<u-form-item label="开户银行网点" prop="openBankBranch" borderBottom labelPosition="top" required="true">
							<dict-picker v-model="form.openBankBranch" :dictValue="ornotOption"></dict-picker>
						</u-form-item>
						<u-form-item label="银行账号" prop="bankAccount" borderBottom labelPosition="top" required="true">
							<u--input placeholder="请输入" v-model="form.bankAccount" border="none"></u--input>
						</u-form-item>
						<u-form-item label="银行预留手机号" prop="reservedPhone" borderBottom labelPosition="top">
							<u--input placeholder="请输入" v-model="form.reservedPhone" border="none"></u--input>
						</u-form-item>
					</view>
					<u-form-item label="是否联合受让" prop="joint" borderBottom labelPosition="top" required="true">
						<dict-picker v-model="form.joint" :dictValue="ornotOption"></dict-picker>
					</u-form-item>
					<!--联合受让为：是，则显示：新增自然人员 和 新增法人人员 按钮-->
					<view v-if="form.joint=='1'">
						<u-row gutter="10" customStyle="margin-bottom: 10px;margin-top:10px">
							<u-col span="6">
								<u-button type="primary" icon="plus-circle-fill" @click="addMember" iconColor="white">&nbsp;添加自然人成员</u-button>
							</u-col>
							<u-col span="6">
								<u-button type="primary" icon="plus-circle-fill" @click="isShowAddLegal=true;isShowBaseInfo=false" iconColor="white">&nbsp;添加法人成员</u-button>
							</u-col>
						</u-row>
					</view>
					<!-- 展示添加的自然人列表 -->
					<view class="naturalListBox clearf" v-for="(item, index) in naturalList" :key="index">
						<view class="clearf">
							<view class="fl" style="color: black;">{{item.name}}</view>
							<view class="fr" v-if="item.farea=='0'">{{item.province+item.city+item.area}}</view>
							<view class="fr" v-else-if="item.farea=='1'">{{item.country}}</view>
							<view class="fr" v-else-if="item.farea=='2'">{{item.gat}}</view>
						</view>
						<view>证件类型：{{item.idType}}</view>
						<view style="margin-bottom: 10px;">证件号码：{{item.id}}</view>
						<u-line></u-line>
						<view class="fr opr-btn">
							<image src="../../static/edit.png" class="imgClass"></image>
							<text type="primary" @click="editNatural(item)">编辑</text>
							<image style="margin-left: 10px;" src="../../static/delete.png" class="imgClass"></image>
							<text type="primary" @click="delNatural(index)">删除</text>
						</view>
					</view>
					 <!-- 展示添加的法人列表 -->
					<view class="naturalListBox clearf" v-for="(item, index) in legalList" :key="index">
						<view class="clearf">
							<view class="fl" style="color: black;">{{item.name}}</view>
							<view class="fr" v-if="item.farea=='0'">{{item.province+item.city+item.area}}</view>
							<view class="fr" v-else-if="item.farea=='1'">{{item.country}}</view>
							<view class="fr" v-else-if="item.farea=='2'">{{item.gat}}</view>
						</view>
						<view>证件类型：{{item.idType}}</view>
						<view style="margin-bottom: 10px;">证件号码：{{item.id}}</view>
						<u-line></u-line>
						<view class="fr opr-btn">
							<image src="../../static/edit.png" class="imgClass"></image>
							<text type="primary" @click="editLegal(item)">编辑</text>
							<image style="margin-left: 10px;" src="../../static/delete.png" class="imgClass"></image>
							<text type="primary" @click="delLegal(index)">删除</text>
						</view>
					</view>
				</view>
				<!-- 添加自然人 和 法人 页面 -->
				<view v-if="current==1 && !isShowBaseInfo">
					<!-- prop属性都有点问题 -->
					<!-- 添加自然人成员页 -->
					<view v-if="isShowAddNatrual">
						<u-form-item label="成员姓名" prop="member.name" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.name" border="none"></u--input>
						</u-form-item>
						<u-form-item label="地域" prop="member.farea" borderBottom labelPosition="top" required="true">
							<dict-picker v-model="member.farea" :dictValue="regionOptions"></dict-picker>
						</u-form-item>
						<!-- 境内 -->
						<u-form-item label="省市区" prop="member.area" borderBottom labelPosition="top" required="true" v-if="member.farea=='0'">
							<view class="taskName2" @click="changeAreaType" style="color: #808080;">
								<text :class="!!member.area ? 'select' : ''">
									{{member.area ? (member.province+member.city+member.area ): '请选择所在地区' }}
								</text>
							</view>
							<u-picker ref="uPicker" :show="showAreaPicker" :columns="columns" @cancel="cancelAreaPicker" @confirm="confirmAreaOfMember" @change="changeHandler"></u-picker>
						</u-form-item>
						<!-- 境外 -->
						<u-form-item label="国家" prop="member.country" borderBottom labelPosition="top" required="true" v-if="member.farea=='1'">
							<view class="taskName2" @click="changeAreaType" style="color: #808080;">
								<text :class="!!member.country ? 'select' : ''">
									{{member.country ? member.country: '请选择国家' }}
								</text>
							</view>
							<u-picker ref="uPicker" :show="showAreaPicker" :columns="country" keyName="label" @cancel="cancelAreaPicker" @confirm="confirmCountryOfMenber"></u-picker>
						</u-form-item>
						<!-- 港澳台 -->
						<u-form-item label="港澳台" prop="member.gat" borderBottom labelPosition="top" required="true" v-if="member.farea=='2'">
							<view class="taskName2" @click="changeAreaType" style="color: #808080;">
								<text :class="!!member.gat ? 'select' : ''">
									{{member.gat ? member.gat: '请选择所在地' }}
								</text>
							</view>
							<u-picker ref="uPicker" :show="showAreaPicker" :columns="gatColumns" keyName="label" @cancel="cancelAreaPicker" @confirm="confirmGatOfMember"></u-picker>
						</u-form-item>
						<u-form-item label="注册地(住所)" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.address" border="none"></u--input>
						</u-form-item>
						<u-form-item label="证件类型" prop="member.idType" labelPosition="top" borderBottom required="true">
							<dict-picker v-model="member.idType" :dictValue="regionOptions"></dict-picker>
						</u-form-item>
						<u-form-item label="证件号码" prop="member.id" labelPosition="top" borderBottom required="true">
							<u--input placeholder="请输入" v-model="member.id" border="none"></u--input>
						</u-form-item>
						<u-form-item label="手机号" prop="member.phone" labelPosition="top" required="true" borderBottom>
							<u--input placeholder="请输入" v-model="member.phone" border="none"></u--input>
						</u-form-item>
						<u-form-item label="联系电话/传真" prop="member.contactPhone" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.contactPhone" border="none"></u--input>
						</u-form-item>
						<u-form-item label="邮箱" prop="member.contactEmail" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.contactEmail" border="none"></u--input>
						</u-form-item>
					</view>
					<!-- 添加法人成员 -->
					<view v-if="isShowAddLegal">
						<u-form-item label="成员姓名" prop="member.name" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.name" border="none"></u--input>
						</u-form-item>
						<u-form-item label="地域" prop="member.farea" borderBottom labelPosition="top" required="true">
							<dict-picker v-model="member.farea" :dictValue="regionOptions"></dict-picker>
						</u-form-item>
						<!-- 境内 -->
						<u-form-item label="省市区" prop="member.area" borderBottom labelPosition="top" required="true" v-if="member.farea==='0'">
							<view class="taskName2" @click="changeAreaType" style="color: #808080;">
								<text :class="!!member.area ? 'select' : ''">
									{{member.area ? (member.province+member.city+member.area ): '请选择所在地区' }}
								</text>
							</view>
							<u-picker ref="uPicker" :show="showAreaPicker" :columns="columns" @cancel="cancelAreaPicker" @confirm="confirmAreaOfMember" @change="changeHandler"></u-picker>
						</u-form-item>
						<!-- 境外 -->
						<u-form-item label="国家" prop="member.country" borderBottom labelPosition="top" required="true" v-if="member.farea==='1'">
							<view class="taskName2" @click="changeAreaType" style="color: #808080;">
								<text :class="!!member.country ? 'select' : ''">
									{{member.country ? member.country: '请选择国家' }}
								</text>
							</view>
							<u-picker ref="uPicker" :show="showAreaPicker" :columns="country" keyName="label" @cancel="cancelAreaPicker" @confirm="confirmCountryOfMenber"></u-picker>
						</u-form-item>
						<!-- 港澳台 -->
						<u-form-item label="港澳台" prop="member.gat" borderBottom labelPosition="top" required="true" v-if="member.farea==='2'">
							<view class="taskName2" @click="changeAreaType" style="color: #808080;">
								<text :class="!!member.gat ? 'select' : ''">
									{{member.gat ? member.gat: '请选择所在地' }}
								</text>
							</view>
							<u-picker ref="uPicker" :show="showAreaPicker" :columns="gatColumns" keyName="label" @cancel="cancelAreaPicker" @confirm="confirmGatOfMember"></u-picker>
						</u-form-item>
						<u-form-item label="注册地(住所)" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.address" border="none"></u--input>
						</u-form-item>
						<u-form-item label="法定代表人或负责人" prop="member.legalRepresentative" labelPosition="top" borderBottom required="true">
							<u--input placeholder="请输入" v-model="member.legalRepresentative" border="none"></u--input>
						</u-form-item>
						<u-form-item label="成立日期" labelPosition="top" borderBottom @click="isShowCalendar=true">
							<u--input placeholder="请输入" disabled="true" suffixIcon="arrow-right" border="none" v-model="member.establishingDate"></u--input>
							<u-calendar :show="isShowCalendar" @confirm="confirmCreateTime" @close="isShowCalendar=false"></u-calendar>
						</u-form-item>
						<u-form-item label="注册资本(万元)" prop="member.registeredCapital" labelPosition="top" borderBottom required="true">
							<u--input placeholder="请输入" v-model="member.registeredCapital" border="none"></u--input>
						</u-form-item>
						<u-form-item label="注册资本币种" prop="member.moneyType" borderBottom labelPosition="top" required="true">
							<dict-picker v-model="member.moneyType" :dictValue="moneyTypeOption"></dict-picker>
						</u-form-item>
						<u-form-item label="所属行业类别" prop="member.industry" labelPosition="top" borderBottom>
							<dict-picker v-model="member.industry" :dictType="'mch_industry'"></dict-picker>
						</u-form-item>
						<u-form-item label="所属行业" prop="member.industry2" labelPosition="top" required="true" borderBottom>
							<dict-picker v-model="member.industry2" :dictType="'mch_industry'"></dict-picker>
						</u-form-item>
						<u-form-item label="企业类型" prop="member.businessType" labelPosition="top" required="true" borderBottom>
							<dict-picker v-model="member.businessType" :dictType="'mch_industry'"></dict-picker>
						</u-form-item>
						<u-form-item label="经济类型" prop="member.economicType" labelPosition="top" required="true" borderBottom>
							<dict-picker v-model="member.economicType" :dictType="'mch_industry'"></dict-picker>
						</u-form-item>
						<u-form-item label="经营规模" prop="member.operationScale" labelPosition="top" required="true" borderBottom>
							<dict-picker v-model="member.operationScale" :dictType="'mch_industry'"></dict-picker>
						</u-form-item>
						<u-form-item label="经营范围" prop="member.businessScope" labelPosition="top" borderBottom required="true">
							<u--input placeholder="请输入" v-model="member.businessScope" border="none"></u--input>
						</u-form-item>
						<u-form-item label="证件类型" prop="member.idType" labelPosition="top" borderBottom required="true">
							<dict-picker v-model="member.idType" :dictValue="regionOptions"></dict-picker>
						</u-form-item>
						<u-form-item label="证件号码" prop="member.id" labelPosition="top" borderBottom required="true">
							<u--input placeholder="请输入" v-model="member.id" border="none"></u--input>
						</u-form-item>
						<u-form-item label="联系人" prop="member.contact" labelPosition="top" borderBottom required="true">
							<u--input placeholder="请输入" v-model="member.contact" border="none"></u--input>
						</u-form-item>
						<u-form-item label="手机号" prop="member.phone" labelPosition="top" required="true" borderBottom>
							<u--input placeholder="请输入" v-model="member.phone" border="none"></u--input>
						</u-form-item>
						<u-form-item label="联系电话/传真" prop="member.contactPhone" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.contactPhone" border="none"></u--input>
						</u-form-item>
						<u-form-item label="邮箱" prop="member.contactEmail" labelPosition="top" borderBottom>
							<u--input placeholder="请输入" v-model="member.contactEmail" border="none"></u--input>
						</u-form-item>
					</view>
					<!-- 添加自然人 或 法人页面底部的按钮 -->
					<view class="personBtn1 bottom-btn">
						<u-row customStyle="margin-bottom: 10px;margin-top:10px">
							<u-col span="6">
								<u-button type="primary" icon="file-text-fill" iconColor="white" @click="cancleAdd">&nbsp;取消</u-button>
							</u-col>
							<u-col span="6">
								<u-button type="primary" icon="checkmark-circle-fill" iconColor="white" @click="confirmAdd">&nbsp;确定</u-button>
							</u-col>
						</u-row>
					</view>
				</view>
				
				<!-- 附件上传 -->
				<view v-if="current==2">
					<u-form-item label="企业法人营业执照" required>
						<u-upload :fileList="enterpriseFileList" @afterRead="afterRead" @delete="deletePic" name="enterpriseFileList" :maxCount="5" uploadIcon="plus" :previewFullImage="true"></u-upload>
					</u-form-item>
					<u-form-item label="自然人相关证件">
						<u-upload :fileList="naturalFileList" @afterRead="afterRead" @delete="deletePic" name="naturalFileList" :maxCount="5" uploadIcon="plus" :previewFullImage="true"></u-upload>
					</u-form-item>
					<u-form-item label="承租申请承诺">
						<u-upload :fileList="commitFileList" @afterRead="afterRead" @delete="deletePic" name="commitFileList" :maxCount="5" uploadIcon="plus" :previewFullImage="true"></u-upload>
					</u-form-item>
					<u-form-item label="补充材料清单">
						<u-upload :fileList="suppleFileList" @afterRead="afterRead" @delete="deletePic" name="suppleFileList" :maxCount="5" uploadIcon="plus" :previewFullImage="true"></u-upload>
					</u-form-item>
				</view>
			</u--form>
		</view>
		
		<!-- 底部按钮 -->
		<view class="personBtn1 bottom-btn" v-if="!isShowAddNatrual&&!isShowAddLegal&&!isSubmit">
			<u-row customStyle="margin-bottom: 10px;margin-top:10px" v-if="current==0">
				<u-col span="6">
					<u-button type="primary" icon="file-text-fill" @click="save" iconColor="white">&nbsp;保存</u-button>
				</u-col>
				<u-col span="6">
					<u-button type="primary" @click="goNextStep" icon="checkmark-circle-fill" iconColor="white">&nbsp;下一步</u-button>
				</u-col>
			</u-row>
			<u-row customStyle="margin-bottom: 10px;margin-top:10px" v-if="current==1">
				<u-col span="4">
					<u-button type="primary" @click="goPreStep" icon="checkmark-circle-fill" iconColor="white">&nbsp;上一步</u-button>
				</u-col>
				<u-col span="4">
					<u-button type="primary" icon="file-text-fill" @click="save" iconColor="white">&nbsp;保存</u-button>
				</u-col>
				<u-col span="4">
					<u-button type="primary" @click="goNextStep" icon="checkmark-circle-fill" iconColor="white">&nbsp;下一步</u-button>
				</u-col>
			</u-row>
			<u-row customStyle="margin-bottom: 10px;margin-top:10px" v-if="current==2">
				<u-col span="6">
					<u-button type="primary" icon="file-text-fill" @click="goPreStep"
						iconColor="white">&nbsp;上一步</u-button>
				</u-col>
				<u-col span="6">
					<u-button type="primary" @click="submitForm" icon="checkmark-circle-fill"
						iconColor="white">&nbsp;提交</u-button>
				</u-col>
			</u-row>
		</view>
		
		<!-- 提交结果页面 -->
		<view v-if="isSubmit">
			<!-- 提交成功 -->
			<view class="u-content" v-if="isSubSuccess">
				<view class="u-content__circle-success">
					<u-icon name="checkmark-circle-fill" color="#3c9cff" size="35"></u-icon>
				</view>
				<text class="u-content__normal-success">报名信息提交成功</text>
			</view>
			<!-- 提交失败 -->
			<view class="u-content" v-if="!isSubSuccess">
				<view class="u-content__circle-error">
					<u-icon name="close-circle-fill" color="#f56c6c" size="35"></u-icon>
				</view>
				<text class="u-content__normal-error">报名信息提交失败</text>
			</view>
		</view>
	</view>
</template>
<script>
	// 引入 config.js ，拿到 baseUrl
	import config from '@/common/config.js'
	export default {
		data() {
			return {
				current: 0,    // u-steps的参数，用于标识目前处于第几步
				isShowBaseInfo: true,    // 展示基本信息填写页
				isShowAddNatrual: false,    // 展示添加自然人页面
				isShowAddLegal: false,    // 展示添加法人页面
				isShowCalendar: false,    // 日期选择
				isSubmit: false,    // 是否已提交
				isSubSuccess: false,    // 是否提交成功
				
				showAreaPicker: false,    // 地域选择
				columns: [], //省份数据显示，三级联动需要三维数组，展示初始数据
				province: [],    // 省份数据
				city: [],    // 市级数据
				area: [[]],    // 区
				country: [],    // 国家数据
				gatColumns: [    // 港澳台数据
					[
						{
							label: "台湾省",
							value: '台湾省'
						},
						{
							label: "香港特别行政区",
							value: '香港特别行政区'
						},
						{
							label: "澳门特别行政区",
							value: '澳门特别行政区'
						},
					]
				],
				
				naturalList: [],    // 自然人列表
				legalList: [],    // 法人列表
				
				// 附件材料清单
				enterpriseFileList: [],
				naturalFileList: [],
				commitFileList: [],
				suppleFileList: [],
				
				form: {
					projectId: '',
					
					// 意向方信息
					interestedPartyType: '',    // 意向方类型
					interestedPartyName: '',    // 意向方名称
					projectId: '',    // 项目编号
					projectName: '',    // 项目名称
					
					farea: '',    // 地域
					province: '',    // 省
					city: '',    // 市
					area: '',    // 区
					country: '',    // 国家
					gat: '',    // 港澳台
					address: '',    // 注册地（住所）
					stateOwned: '',    // 是否是国资企业
					legalRepresentative: '',    // 法定代表人
					idType: '',    // 证件类别
					unifiedSocialCreditCode: '',    // 证件编号
					industry: '',    // 所属行业类别
					industry2: '',    // 所属行业
					registeredCapital: '',    // 注册资本
					moneyType: '',    // 注册资本币种
					businessType: '',    // 企业类型
					operationScale: '',    // 经营规模
					economicType: '',    // 经济类型
					contacts: '',    // 联系人
					contactPhone: '',    // 联系人手机号
					contactAddress: '',    // 通讯地址
					contactEmail: '',    // 联系人电子邮箱
					businessScope: '',    // 经营范围
					
					// 基本信息
					// obligee: '',    // 是否权利人
					payForAnother: '',    // 是否代付
					concerningForeign: '',    // 是否涉外
					// 当代付和涉外为："否" 时，需填写银行卡信息
					bankCard: '',    // 我的银行卡
					cardAccountName: '',    // 银行卡账号名称
					openAccountBank: '',    // 开户银行
					openBankBranch: '',    // 开户银行网点
					bankAccount: '',    // 银行账号
					reservedPhone: '',    // 银行预留手机号
					
					joint: '',    // 是否联合受让
					
					members: [],
					materials: [],    // 材料清单
					materials2: [],    // 材料清单
					
				},
				member: {    // 自然人&法人(即联合体成员)
					name: '',
					farea: '',
					province: '',
					city: '',
					area: '',
					country: '',
					gat: '',
					address: '',
					
					idType: '',
					id: '',
					phone: '',
					contactPhone: '',
					contactEmail: '',
					// 添加法人的额外字段
					legalRepresentative: '',
					establishingDate: '',
					registeredCapital: '',
					moneyType: '',
					industry: '',
					industry: '',
					businessType: '',
					economicType: '',
					operationScale: '',
					businessScope: '',
					contact: '',
				},
				material: {    // 附件材料
					name: '',    // 材料名称
					remark: '',    // 材料备注
					index: '',    // 材料序号
					id: 0,    // 材料主键
					handleType: 0,    // 材料操作类型
					type: 3,    // 要件类型
					files: ['', 1, '', '', 0, '']    // 文件列表参数？
				},
				material2: {    // 附件材料2
					name: '',
					remark: '',
					id: 0,
					handleType: 0,
					type: 3,
					files: ['', 1, '', '', 0, '']
				},
				count: 0,
				
				rules: [],
				
				// 字典
				moneyTypeOption: [
					{
						label: '人民币',
						value: 'RMB'
					},
					{
						label: '日元',
						value: 'RY'
					},
					{
						label: '欧元',
						value: 'OY'
					},
					{
						label: '美元',
						value: 'MY'
					},
					{
						label: '港币',
						value: 'GB'
					},
					{
						label: '台币',
						value: 'TB'
					},
					{
						label: '德国马克',
						value: 'DM'
					},
				],
				ornotOption: [
					{
						label: '是',
						value: '1'
					},
					{
						label: '否',
						value: '0'
					},
				],
				regionOptions: [
					{
						label: "境内",
						value: '0'
					},
					{
						label: "境外",
						value: '1'
					},
					{
						label: "港澳台",
						value: '2'
					},
				],
			}
		},
		onLoad() {
			// 获取省市区、国家、港澳台城市信息
			this.getAddressInfo()
		},
		methods: {
			// 上一步
			goPreStep() {
				--this.current
			},
			// 下一步
			goNextStep() {
				if (this.current < 3) {
					++this.current
					console.log(this.current, "current")
				}
			},
			// 保存填写的信息
			save() {
				console.log('将用户填写的信息保存下来')
				uni.showToast({
					title: '保存成功'
				})
			},
			
			// 获取省市区 和 国家信息
			getAddressInfo() {
				// 获取省市区数据
				uni.request({
					url: `${config.uploadUrl}/assets/js/address/address.json`,
					success: res => {
						// 直接处理好再存入data中不会太卡顿
						const addressInfo = res.data
						let cityInfo = []
						let areaInfo = []
						
						let province = []    // 省份信息
						let city = []    // 市级信息
						let area = [[]]    // 区信息
						
						// 提取出 省份
						province = addressInfo.map(item => item.name)
						this.columns.push(province)
						
						// 提取出 市
						cityInfo = addressInfo.map(item => item.children)
						cityInfo.forEach(item => {
							const everyCity = item.map(i => i.name)
							city.push(everyCity)
						})
						this.city = city
						this.columns.push(city[0])
						
						// 提取出 区
						cityInfo.forEach(item => {
							const everyAreaInfo = item.map(i => i.children)
							areaInfo.push(everyAreaInfo)
						})
						areaInfo.forEach((item,index) => {
							area[index] = []
							item.forEach(i => {
								const everyArea = i.map(j => j.name)
								area[index].push(everyArea)
							})
						})
						this.area = area
						this.columns.push(this.area[0][0])
					}
				})
				// 获取国家信息
				uni.request({
					url: `${config.uploadUrl}/assets/js/address/country.json`,
					success: res => {
						this.country.push(res.data)
					}
				})
			},
			
			// 点击选择地区后，弹出 Picker 选择器
			changeAreaType() {
				this.showAreaPicker = true
			},
			
			// 点击确定，保存 省/市/区 信息并关闭 Picker 选择器
			confirmArea(e) {
				this.form.province = e.value[0]
				this.form.city = e.value[1]
				this.form.area = e.value[2]
				this.showAreaPicker = false
			},
			// 点击确定，保存 国家 信息并关闭 Picker 选择器
			confirmCountry(e) {
				this.form.country = e.value[0].label
				this.showAreaPicker = false
			},
			// 点击确定，保存 港澳台 信息并关闭 Picker 选择器
			confirmGat(e) {
				this.form.gat = e.value[0].label
				this.showAreaPicker = false
			},
			// 点击确定，保存 自然人or法人的 省/市/区 信息并关闭 Picker 选择器
			confirmAreaOfMember(e) {
				this.member.province = e.value[0]
				this.member.city = e.value[1]
				this.member.area = e.value[2]
				this.showAreaPicker = false
			},
			// 点击确定，保存 自然人or法人的 国家 信息并关闭 Picker 选择器
			confirmCountryOfMenber(e) {
				this.member.country = e.value[0].label
				this.showAreaPicker = false
			},
			// 点击确定，保存 自然人or法人的 港澳台 信息并关闭 Picker 选择器
			confirmGatOfMember(e) {
				this.member.gat = e.value[0].label
				this.showAreaPicker = false
			},
			
			//省/市/区选择时触发
			changeHandler(e) {
				const {
					columnIndex,
					value,
					values,
					index,
					indexs,
					picker = this.$refs.uPicker
				} = e
				// console.log('------------------eeeeee',e)
				// 当第一列值发生变化时，第二列第三列跟着变化
				if (columnIndex === 0) {
					picker.setColumnValues(1, this.city[index])
					picker.setColumnValues(2, this.area[index][0])
				}
				// 当第二列值发生变化时，第三列跟着变化
				if (columnIndex === 1) {
					picker.setColumnValues(2, this.area[indexs[0]][index])
				}
			},
			
			// 点击取消，关闭 Picker选择器
			cancelAreaPicker(e) {
				this.showAreaPicker = false
			},
			
			// 确定创建日期
			confirmCreateTime(e) {
				// console.log('------------------e',e)
				this.member.establishingDate = e[0]
				this.isShowCalendar = false
			},
			
			addMember() {
				// 添加完成后置空，有bug
				// setTimeout(() => {
					// Object.keys(this.form.member).forEach(key => {
					// 	this.form.member[key] = ''
					// })
				// },2000)
				this.isShowAddNatrual=true
				this.isShowBaseInfo=false
			},
			
			// 确定添加自然人 or 法人
			confirmAdd() {
				let member = JSON.parse(JSON.stringify(this.member))
				// 添加自然人
				if (this.isShowAddNatrual) {
					this.form.members.push(member)
					this.naturalList.push(member)
				}
				// 添加法人
				if (this.isShowAddLegal) {
					this.form.members.push(member)
					this.legalList.push(member)
				}
				
				this.isShowAddLegal = false
				this.isShowAddNatrual = false
				this.isShowBaseInfo = true
				
				// 添加完成后置空(有bug)
				// Object.keys(this.member).forEach(key => {
				// 	this.member[key] = ''
				// })
			},
			
			// 取消添加添加自然人 or 法人
			cancleAdd() {
				this.isShowAddLegal = false
				this.isShowAddNatrual = false
				this.isShowBaseInfo = true
			},
			
			// 添加自然人
			addNatural() {
				// this.naturalList.push(this.form.member)
				console.log('111')
			},
			// 添加法人
			addLegal() {
				this.legalList.push({
					name: '测试'
				})
			},
			
			// 编辑自然人
			editNatural(item) {
				// 自然人编辑赋值
				console.log('-----------111')
				// this.isShowAddNatrual = false
				// this.isShowBaseInfo = true
			},
			// 删除自然人
			delNatural(index) {
				console.log('-----------111')
				// this.naturalList = this.naturalList.filter((val, idx) => {
				// 	return idx != index;
				// })
			},
			// 编辑法人
			editLegal(item) {
				// 法人编辑赋值
				console.log('-----------222')
				// this.isShowAddLegal = false
				// this.isShowBaseInfo = true
			},
			// 删除法人
			delLegal() {
				console.log('---------222')
			},
			
			// 上传附件
			async afterRead(event) {
				// console.log('--------------event',event)
				const lists = [].concat(event.file)
				uni.showLoading({
					title: "上传中..."
				})
				// 将文件上传到服务器
				const result = await this.uploadFilePromise(lists[0].url, 2)
				const res = JSON.parse(result)
				console.log('------------res',res)
				if (res.code == 200) {
					// 将文件存在预览列表中
					// 直接使用 res 中的 url访问不到（应该是https才行），所以这里拼接一下
					const fileUrl = config.uploadUrl + res.fileName
					this[`${event.name}`].push({
						url: fileUrl,
						name: res.newFileName
					})
					// 将文件信息存入表单
					this.saveMaterialInfo(event,res)
					// this.$forceUpdate()    // 强刷新？
					uni.showToast({
						title: '上传成功'
					})
				} else if (res.code == 401) {
					uni.reLaunch({
						url: '../login/login'
					})
				} else {
					uni.$u.toast(res.msg)
				}
				uni.hideLoading();
			},
			uploadFilePromise(url, type) {
				console.log()
				let path = config.baseUrl + '/common/upload'
				return new Promise((resolve, reject) => {
					let a = uni.uploadFile({
						url: path,
						filePath: url,
						name: 'file',
						header: {
							Authorization: uni.getStorageSync('token'),
							// 'content-type': 'application/x-www-form-urlencoded;charset=utf-8',
						},
						formData: {
							fileName: 'test.png'
						},
						success: (res) => {
							resolve(res.data)
						}
					})
				})
			},
			
			// 将文件信息存入表单
			saveMaterialInfo(e,info) {
				// console.log('----------------eee',e)
				// console.log('----------------info',info)
				const index = String(this.count)
				
				this.material.name = info.newFileName
				this.material.index = index
				const material = JSON.parse(JSON.stringify(this.material))
				this.form.materials.push(material)
				
				this.material2.name = info.newFileName
				const material2 = JSON.parse(JSON.stringify(this.material2))
				this.form.materials2.push(material2)
				this.count++
			},
			
			// 最终提交
			submitForm() {
				// this.$u.api.intentionSubmitReg(this.form).then(
				// 	res => {
				// 		if(res.code == 200) {
				// 			console.log('----------请求成功',res)
				// 		}
				// 	},
				// 	err => {
				// 		console.log('-----------err',err)
				// 	}
				// )
				this.isSubmit = true
				// 请求提交接口
				this.isSubSuccess = true;
				// current加 1，使步骤 3也变为 √
				this.current++
			},
		},	
	}
</script>

<style scoped lang="scss">
	.header {
		margin: 10px 0px;
	}

	::v-deep .u-input__content {
		background: white;
	}

	::v-deep .u-input__content__field-wrapper__field {
		background: white !important;
	}

	.fl {
		float: left;
		display: inline-block;
	}

	.fr {
		float: right;
		display: inline-block;
	}

	.clearf {
		overflow: hidden;
	}

	.u-content {
		padding: 150px 60px 0;
		@include flex(column);
		align-items: center;
		justify-content: center;

		&__circl-success {
			background-color: #3c9cff;
			@include flex;
			border-radius: 100px;
			width: 60px;
			height: 60px;
			align-items: center;
			justify-content: center;
		}

		&__circl-error {
			background-color: #f56cf5;
			@include flex;
			border-radius: 100px;
			width: 60px;
			height: 60px;
			align-items: center;
			justify-content: center;
		}

		&__normal-success {
			font-size: 15px;
			color: #3c9cff;
			margin-top: 15px;
		}

		&__normal-error {
			font-size: 15px;
			color: #f56cf5;
			margin-top: 15px;
		}
	}

	.ellipsisTxt {
		max-width: 24vw;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
	}

	.bottom-btn {
		::v-deep .u-button {
			width: 90% !important;
		}
	}

	.intentionalInfoBox {
		padding: 10px;
		padding-bottom: 15vh;
	}

	.card-bottom {
		display: flex;
		justify-content: space-between;
		align-items: center;

		.time {
			flex: 3;
			display: flex;
			align-items: center;
		}

		.audit-status {
			flex: 1;
		}
	}

	.signUpIntentionalInfo {
		// display: flex;
		// flex-direction: column;
		height: 100vh;
		padding: 10px 10px 120px 0px;
		margin-bottom: 50px;
	}

	.sign-foot {
		position: sticky;
		left: 0;
		bottom: 0;
		right: 0;
		width: 100%;
		height: 140rpx;
		background-color: #fff;
		display: flex;
		align-items: center;
		position: fixed;
		bottom: 0;
	}

	.sign-apply-name {
		height: 32px;
		width: 140px;
		margin: 0 40rpx;
		padding: 6rpx 32rpx;
		background-color: #004692;
		text-align: center;
		font-size: 24rpx;
		line-height: 2rem;
		color: #fff;
		border-radius: 10px;
	}

	.imgClass {
		width: 15px;
		height: 15px;
		vertical-align: middle;
	}

	.naturalListBox {
		padding: 10px;
		background-color: white;
		color: gray;
		margin: 10px 0;
		box-shadow: 0 1px 2px 2px rgba(0,0,0,.1);

		view {
			margin-top: 10px;
		}
	}

	.opr-btn {
		// margin-left: 10px;
		// /* float: left; */
		// display: inline-block;
		// padding-top: 15px;
	}

	.opr-btn text {
		color: #0071fe;
		padding-left: 6px;
	}
</style>
```

